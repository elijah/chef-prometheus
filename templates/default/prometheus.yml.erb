# Global default settings.
global:
  scrape_interval: "15s"     # By default, scrape targets every 15 seconds.
  evaluation_interval: "15s" # By default, evaluate rules every 15 seconds.

scrape_configs:
<% @jobs.each do |name, job| %>
- job_name: "<%= name %>"
  <% if job['scrape_interval'] %>
  scrape_interval: "<%= job['scrape_interval'] %>"
  <% end %>
  <% if job['scrape_timeout'] %>
  scrape_timeout: "<%= job['scrape_timeout'] %>"
  <% end %>
  metrics_path: "<%= job['metrics_path'] %>"
  static_configs:
    - targets: <%=  Array(job['target']) %>
    <%if job['labels'] %>
      labels:
      <% job['labels'].each do |label,label_config| %>
        <%=label%>: <%=label_config%>
      <%end%>
    <%end%>

  <% end %>

<% if @rule_filenames %>
rule_files:
<% @rule_filenames.each do |filename| %>
  - <%= filename %>
<% end %>
<% end %>

